"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[6381],{"Bx/C":function(e,t,r){r.d(t,{BP:function(){return c},K0:function(){return o},NP:function(){return i},Pc:function(){return a},Uj:function(){return n},_G:function(){return l},ar:function(){return u},e4:function(){return d},se:function(){return s},wm:function(){return f}}),r("60oc"),r("kvaN"),r("o5/U"),r("pacc"),r("vDqi");const n=[{suffix:"md",formatFun:e=>e},{suffix:"js",formatFun:e=>"```javascript\n"+e+"\n```"},{suffix:"ts",formatFun:e=>"```typescript\n"+e+"\n```"},{suffix:"jsx",formatFun:e=>"```jsx\n"+e+"\n```"},{suffix:"html",formatFun:e=>"```html\n"+e+"\n```"},{suffix:"css",formatFun:e=>"```css\n"+e+"\n```"},{suffix:"less",formatFun:e=>"```less\n"+e+"\n```"},{suffix:"scss",formatFun:e=>"```scss\n"+e+"\n```"},{suffix:"py",formatFun:e=>"```python\n"+e+"\n```"}],l=e=>n.filter((t=>t.suffix===e)).length,o=e=>["jpg","png","gif","jpeg"].filter((t=>t===e)).length,a=(e,t=0,r)=>{if(0===(o=e.children("h3")).length)return 0<(n=e.children("a")).length?Object.freeze({name:n.text(),href:n.attr("href"),...n.attr("icon")?{icon:n.attr("icon")}:{}}):null;var n=o.text(),l=[],o={ifRender:!1,ifShow:!1},s=e.children("dl").children("dt");for(let e=0;e<s.length;e++){var u=a(s.eq(e));l.push(u)}return o.name=n,o.child=l,o},s=(e,t)=>Math.round(Math.random()*(t-e)+e),u=()=>window.location.origin+window.location.pathname,c=e=>new Promise((t=>{var r=new FileReader;r.readAsDataURL(e),r.onload=e=>{t(e.target.result)}})),i=(e=!0)=>{var t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];if(e){let e="#";for(let r=0;r<6;r++)e+=t[Math.floor(Math.random()*t.length)];return e}return`rgb(${Math.floor(256*Math.random())},${Math.floor(256*Math.random())},${Math.floor(256*Math.random())})`},d=e=>{const t="data-loadtype",r="asyncloadjs";return new Promise(((n,l)=>{if(!document)return l(new Error("document not find"));let o=document.querySelector(`script[src="${e}"][${t}="${r}"]`);o&&(o.parentNode.removeChild(o),o=null),(o=document.createElement("script")).type="text/javascript",o.src=e,o.setAttribute(t,r),document.head.appendChild(o),o.onload=e=>{n()},o.onerror=e=>{l(new Error(e))}}))},f=e=>{const t="data-loadtype",r="asyncloadcss";return new Promise(((n,l)=>{if(!document)return l(new Error("document not find"));let o=document.querySelector(`link[href="${e}"][${t}="${r}"]`);o&&(o.parentNode.removeChild(o),o=null),(o=document.createElement("link")).href=e,o.rel="stylesheet",o.type="text/css",o.setAttribute(t,r),document.head.appendChild(o),o.onload=()=>{n()},o.onerror=e=>{l(new Error(e))}}))}},f1Oo:function(e,t,r){r.r(t),r.d(t,{default:function(){return R}});var n=r("XEAi");const l={class:"office-file-preview"};var o=r("oekR"),a=(t=r("LUbU"),r.n(t)),s=r("gw9Z");const u={class:"preview-wrapper"},c={class:"operate-area"},i={style:{"margin-right":"10px"}},d={key:0},f=["placeholder"],p={key:1},h=["accept"];t={__name:"previewWrapper",props:{accept:String,placeholder:String,defaultSrc:String},setup(e){const t=e,{type:r,inputSrc:l,src:a,beforeUpload:m}=function(e){var t=(0,o.KR)("url"),r=(0,o.KR)(e);const n=(0,o.KR)(e);return e=(0,o.KR)([]),{type:t,inputSrc:r,src:n,fileList:e,beforeUpload:function(e){var t=new FileReader;return t.onload=e=>{e=e.target.result,n.value=e},t.readAsArrayBuffer(e.target.files[0]),!1}}}(t.defaultSrc);return(b,x)=>((0,n.uX)(),(0,n.CE)("div",u,[(0,n.Lk)("div",c,[(0,n.Lk)("div",i,["upload"===(0,o.R1)(r)?((0,n.uX)(),(0,n.CE)("button",{key:0,value:"url",onClick:x[0]||(x[0]=e=>r.value="url")},"远程文件地址")):(0,n.Q3)("",!0),"url"===(0,o.R1)(r)?((0,n.uX)(),(0,n.CE)("button",{key:1,value:"upload",onClick:x[1]||(x[1]=e=>r.value="upload")},"上传本地文件")):(0,n.Q3)("",!0)]),"url"===(0,o.R1)(r)?((0,n.uX)(),(0,n.CE)("div",d,[(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":x[2]||(x[2]=e=>(0,o.i9)(l)?l.value=e:null),placeholder:t.placeholder,style:{width:"600px","margin-left":"10px"}},null,8,f),[[s.Jo,(0,o.R1)(l)]]),(0,n.Lk)("button",{type:"primary",style:{"margin-left":"10px"},onClick:x[3]||(x[3]=e=>a.value=(0,o.R1)(l))}," 预览 ")])):(0,n.Q3)("",!0),"url"!==(0,o.R1)(r)?((0,n.uX)(),(0,n.CE)("div",p,[(0,n.Lk)("input",{accept:e.accept,type:"file",onChange:x[4]||(x[4]=(...e)=>(0,o.R1)(m)&&(0,o.R1)(m)(...e))},null,40,h)])):(0,n.Q3)("",!0)]),(0,n.RG)(b.$slots,"default",{src:(0,o.R1)(a)})]))}};var m=r("uaZu"),b=(0,m.A)(t,[["__scopeId","data-v-51c2a195"]]),x=(t={__name:"docxDemo",props:{baseUrl:String},setup(e){return(t,r)=>((0,n.uX)(),(0,n.Wv)(b,{accept:".docx",placeholder:"请输入docx文件地址","default-src":e.baseUrl+"demo-static/excel-preview-edit/mock-file/01test.docx"},{default:(0,n.k6)((e=>[(0,n.bF)((0,o.R1)(a()),{src:e.src,style:{flex:"1",height:"0"}},null,8,["src"])])),_:1},8,["default-src"]))}},t=(0,m.A)(t,[["__scopeId","data-v-65b0f684"]]),r("tpBA")),v=r.n(x),g=(x={__name:"excelDemo",props:{baseUrl:String},setup(e){return(t,r)=>((0,n.uX)(),(0,n.Wv)(b,{accept:".xlsx",placeholder:"请输入xlsx文件地址","default-src":e.baseUrl+"demo-static/excel-preview-edit/mock-file/01test.xlsx"},{default:(0,n.k6)((e=>[(0,n.bF)((0,o.R1)(v()),{src:e.src,style:{flex:"1",height:"0"}},null,8,["src"])])),_:1},8,["default-src"]))}},r("oUfE")),y=r.n(g),w=(g={__name:"pdfDemo",props:{baseUrl:String},setup(e){return(t,r)=>((0,n.uX)(),(0,n.Wv)(b,{accept:".pdf",placeholder:"请输入pdf文件地址","default-src":e.baseUrl+"demo-static/excel-preview-edit/mock-file/01test.pdf"},{default:(0,n.k6)((e=>[(0,n.bF)((0,o.R1)(y()),{src:e.src,style:{flex:"1",height:"0"}},null,8,["src"])])),_:1},8,["default-src"]))}},r("60oc"),{props:{tabsList:{type:Array,default:()=>[]},activeIndex:{type:Number,default:0}},setup(e,{slots:t}){const r=(0,o.Kh)([]),n=(0,o.KR)(e.activeIndex);return t.default().forEach(((e,t)=>{r.push({ifShow:n.value===t,ifRender:n.value===t,component:(0,o.IG)(e)})})),{currentIndex:n,slotList:r}},render(){return(0,n.bF)("div",{class:"flex flex-direction-column height100"},[(0,n.bF)("div",{class:"flex tabs"},[this.tabsList.map(((e,t)=>(0,n.bF)("div",{class:"cursor-pointer tabs-item",style:{borderRight:"1px solid #000",...0===t?{borderLeft:"1px solid #000"}:{},...this.currentIndex===t?{color:"green",fontWeight:"bolder"}:{}},onClick:()=>{this.slotList[t].ifRender=!0,this.currentIndex=t,this.slotList.forEach(((e,t)=>{e.ifShow=t===this.currentIndex}))},key:t},[e.title])))]),(0,n.bF)("div",{class:"overflow-auto flex-1"},[(0,n.bF)("div",null,[this.slotList.map((e=>{var t=e.component;return e.ifRender?(0,n.bF)(t,{style:e.ifShow?{}:{display:"none"}},null):null}))])])])}}),k=(w=(0,m.A)(w,[["__scopeId","data-v-4f6bc909"]]),r("Bx/C")),R=(0,m.A)({components:{tabs:w,DocxDemo:t,ExcelDemo:x,PdfDemo:g},setup(){return{baseUrl:(0,k.ar)()}}},[["render",function(e,t,r,o,a,s){const u=(0,n.g2)("DocxDemo"),c=(0,n.g2)("ExcelDemo"),i=(0,n.g2)("PdfDemo");var d=(0,n.g2)("tabs");return(0,n.uX)(),(0,n.CE)("div",l,[(0,n.bF)(d,{tabsList:[{title:"预览docx"},{title:"预览excel"},{title:"预览pdf"}]},{default:(0,n.k6)((()=>[(0,n.bF)(u,{baseUrl:o.baseUrl},null,8,["baseUrl"]),(0,n.bF)(c,{baseUrl:o.baseUrl},null,8,["baseUrl"]),(0,n.bF)(i,{baseUrl:o.baseUrl},null,8,["baseUrl"])])),_:1})])}],["__scopeId","data-v-1655563b"]])}}]);