"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[6381],{"Bx/C":function(e,t,r){r.d(t,{BP:function(){return s},K0:function(){return n},NP:function(){return i},Pc:function(){return o},_G:function(){return l},ar:function(){return c},e4:function(){return u},se:function(){return a},wm:function(){return d}}),r("60oc"),r("kvaN"),r("o5/U"),r("pacc"),r("vDqi");const l=e=>["md","js","ts","jsx","html","py"].filter((t=>t===e)).length,n=e=>["jpg","png","gif","jpeg"].filter((t=>t===e)).length,o=(e,t=0,r)=>{if(0===(a=e.children("h3")).length)return 0<(l=e.children("a")).length?Object.freeze({name:l.text(),href:l.attr("href"),...l.attr("icon")?{icon:l.attr("icon")}:{}}):null;var l=a.text(),n=[],a={ifRender:!1,ifShow:!1},c=e.children("dl").children("dt");for(let e=0;e<c.length;e++){var s=o(c.eq(e));n.push(s)}return a.name=l,a.child=n,a},a=(e,t)=>Math.round(Math.random()*(t-e)+e),c=()=>window.location.origin+window.location.pathname,s=e=>new Promise((t=>{var r=new FileReader;r.readAsDataURL(e),r.onload=e=>{t(e.target.result)}})),i=(e=!0)=>{var t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];if(e){let e="#";for(let r=0;r<6;r++)e+=t[Math.floor(Math.random()*t.length)];return e}return`rgb(${Math.floor(256*Math.random())},${Math.floor(256*Math.random())},${Math.floor(256*Math.random())})`},u=e=>{const t="data-loadtype",r="asyncloadjs";return new Promise(((l,n)=>{if(!document)return n(new Error("document not find"));let o=document.querySelector(`script[src="${e}"][${t}="${r}"]`);o&&(o.parentNode.removeChild(o),o=null),(o=document.createElement("script")).type="text/javascript",o.src=e,o.setAttribute(t,r),document.head.appendChild(o),o.onload=e=>{l()},o.onerror=e=>{n(new Error(e))}}))},d=e=>{const t="data-loadtype",r="asyncloadcss";return new Promise(((l,n)=>{if(!document)return n(new Error("document not find"));let o=document.querySelector(`link[href="${e}"][${t}="${r}"]`);o&&(o.parentNode.removeChild(o),o=null),(o=document.createElement("link")).href=e,o.rel="stylesheet",o.type="text/css",o.setAttribute(t,r),document.head.appendChild(o),o.onload=()=>{l()},o.onerror=e=>{n(new Error(e))}}))}},f1Oo:function(e,t,r){r.r(t),r.d(t,{default:function(){return R}});var l=r("XEAi");const n={class:"office-file-preview"};var o=r("oekR"),a=(t=r("LUbU"),r.n(t)),c=r("gw9Z");const s={class:"preview-wrapper"},i={class:"operate-area"},u={style:{"margin-right":"10px"}},d={key:0},p=["placeholder"],f={key:1},h=["accept"];t={__name:"previewWrapper",props:{accept:String,placeholder:String,defaultSrc:String},setup(e){const t=e,{type:r,inputSrc:n,src:a,beforeUpload:m}=function(e){var t=(0,o.KR)("url"),r=(0,o.KR)(e);const l=(0,o.KR)(e);return e=(0,o.KR)([]),{type:t,inputSrc:r,src:l,fileList:e,beforeUpload:function(e){var t=new FileReader;return t.onload=e=>{e=e.target.result,l.value=e},t.readAsArrayBuffer(e.target.files[0]),!1}}}(t.defaultSrc);return(b,v)=>((0,l.uX)(),(0,l.CE)("div",s,[(0,l.Lk)("div",i,[(0,l.Lk)("div",u,["upload"===(0,o.R1)(r)?((0,l.uX)(),(0,l.CE)("button",{key:0,value:"url",onClick:v[0]||(v[0]=e=>r.value="url")},"远程文件地址")):(0,l.Q3)("",!0),"url"===(0,o.R1)(r)?((0,l.uX)(),(0,l.CE)("button",{key:1,value:"upload",onClick:v[1]||(v[1]=e=>r.value="upload")},"上传本地文件")):(0,l.Q3)("",!0)]),"url"===(0,o.R1)(r)?((0,l.uX)(),(0,l.CE)("div",d,[(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":v[2]||(v[2]=e=>(0,o.i9)(n)?n.value=e:null),placeholder:t.placeholder,style:{width:"600px","margin-left":"10px"}},null,8,p),[[c.Jo,(0,o.R1)(n)]]),(0,l.Lk)("button",{type:"primary",style:{"margin-left":"10px"},onClick:v[3]||(v[3]=e=>a.value=(0,o.R1)(n))}," 预览 ")])):(0,l.Q3)("",!0),"url"!==(0,o.R1)(r)?((0,l.uX)(),(0,l.CE)("div",f,[(0,l.Lk)("input",{accept:e.accept,type:"file",onChange:v[4]||(v[4]=(...e)=>(0,o.R1)(m)&&(0,o.R1)(m)(...e))},null,40,h)])):(0,l.Q3)("",!0)]),(0,l.RG)(b.$slots,"default",{src:(0,o.R1)(a)})]))}};var m=r("uaZu"),b=(0,m.A)(t,[["__scopeId","data-v-51c2a195"]]),v=(t={__name:"docxDemo",props:{baseUrl:String},setup(e){return(t,r)=>((0,l.uX)(),(0,l.Wv)(b,{accept:".docx",placeholder:"请输入docx文件地址","default-src":e.baseUrl+"demo-static/excel-preview-edit/mock-file/01test.docx"},{default:(0,l.k6)((e=>[(0,l.bF)((0,o.R1)(a()),{src:e.src,style:{flex:"1",height:"0"}},null,8,["src"])])),_:1},8,["default-src"]))}},t=(0,m.A)(t,[["__scopeId","data-v-65b0f684"]]),r("tpBA")),x=r.n(v),g=(v={__name:"excelDemo",props:{baseUrl:String},setup(e){return(t,r)=>((0,l.uX)(),(0,l.Wv)(b,{accept:".xlsx",placeholder:"请输入xlsx文件地址","default-src":e.baseUrl+"demo-static/excel-preview-edit/mock-file/01test.xlsx"},{default:(0,l.k6)((e=>[(0,l.bF)((0,o.R1)(x()),{src:e.src,style:{flex:"1",height:"0"}},null,8,["src"])])),_:1},8,["default-src"]))}},r("oUfE")),y=r.n(g),w=(g={__name:"pdfDemo",props:{baseUrl:String},setup(e){return(t,r)=>((0,l.uX)(),(0,l.Wv)(b,{accept:".pdf",placeholder:"请输入pdf文件地址","default-src":e.baseUrl+"demo-static/excel-preview-edit/mock-file/01test.pdf"},{default:(0,l.k6)((e=>[(0,l.bF)((0,o.R1)(y()),{src:e.src,style:{flex:"1",height:"0"}},null,8,["src"])])),_:1},8,["default-src"]))}},r("60oc"),{props:{tabsList:{type:Array,default:()=>[]},activeIndex:{type:Number,default:0}},setup(e,{slots:t}){const r=(0,o.Kh)([]),l=(0,o.KR)(e.activeIndex);return t.default().forEach(((e,t)=>{r.push({ifShow:l.value===t,ifRender:l.value===t,component:(0,o.IG)(e)})})),{currentIndex:l,slotList:r}},render(){return(0,l.bF)("div",{class:"flex flex-direction-column height100"},[(0,l.bF)("div",{class:"flex tabs"},[this.tabsList.map(((e,t)=>(0,l.bF)("div",{class:"cursor-pointer tabs-item",style:{borderRight:"1px solid #000",...0===t?{borderLeft:"1px solid #000"}:{},...this.currentIndex===t?{color:"green",fontWeight:"bolder"}:{}},onClick:()=>{this.slotList[t].ifRender=!0,this.currentIndex=t,this.slotList.forEach(((e,t)=>{e.ifShow=t===this.currentIndex}))},key:t},[e.title])))]),(0,l.bF)("div",{class:"overflow-auto flex-1"},[(0,l.bF)("div",null,[this.slotList.map((e=>{var t=e.component;return e.ifRender?(0,l.bF)(t,{style:e.ifShow?{}:{display:"none"}},null):null}))])])])}}),k=(w=(0,m.A)(w,[["__scopeId","data-v-4f6bc909"]]),r("Bx/C")),R=(0,m.A)({components:{tabs:w,DocxDemo:t,ExcelDemo:v,PdfDemo:g},setup(){return{baseUrl:(0,k.ar)()}}},[["render",function(e,t,r,o,a,c){const s=(0,l.g2)("DocxDemo"),i=(0,l.g2)("ExcelDemo"),u=(0,l.g2)("PdfDemo");var d=(0,l.g2)("tabs");return(0,l.uX)(),(0,l.CE)("div",n,[(0,l.bF)(d,{tabsList:[{title:"预览docx"},{title:"预览excel"},{title:"预览pdf"}]},{default:(0,l.k6)((()=>[(0,l.bF)(s,{baseUrl:o.baseUrl},null,8,["baseUrl"]),(0,l.bF)(i,{baseUrl:o.baseUrl},null,8,["baseUrl"]),(0,l.bF)(u,{baseUrl:o.baseUrl},null,8,["baseUrl"])])),_:1})])}],["__scopeId","data-v-1655563b"]])}}]);