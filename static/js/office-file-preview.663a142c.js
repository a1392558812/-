"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[6381],{HlMS:function(e,t,r){r.d(t,{BP:function(){return c},K0:function(){return a},NP:function(){return i},Pc:function(){return n},_G:function(){return l},ar:function(){return s},se:function(){return o}}),r("60oc"),r("kvaN"),r("o5/U"),r("pacc"),r("vDqi");const l=e=>["md","js","ts","jsx","html","py"].filter((t=>t===e)).length,a=e=>["jpg","png","gif","jpeg"].filter((t=>t===e)).length,n=(e,t=0,r)=>{if(0===(o=e.children("h3")).length)return 0<(l=e.children("a")).length?Object.freeze({name:l.text(),href:l.attr("href"),...l.attr("icon")?{icon:l.attr("icon")}:{}}):null;var l=o.text(),a=[],o={ifRender:!1,ifShow:!1},s=e.children("dl").children("dt");for(let e=0;e<s.length;e++){var c=n(s.eq(e));a.push(c)}return o.name=l,o.child=a,o},o=(e,t)=>Math.round(Math.random()*(t-e)+e),s=()=>window.location.origin+window.location.pathname,c=e=>new Promise((t=>{var r=new FileReader;r.readAsDataURL(e),r.onload=e=>{t(e.target.result)}})),i=(e=!0)=>{var t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];if(e){let e="#";for(let r=0;r<6;r++)e+=t[Math.floor(Math.random()*t.length)];return e}return`rgb(${Math.floor(256*Math.random())},${Math.floor(256*Math.random())},${Math.floor(256*Math.random())})`}},K2T2:function(e,t,r){r.r(t),r.d(t,{default:function(){return U}});var l=r("XEAi");const a={class:"office-file-preview"};var n=r("oekR"),o=(t=r("LUbU"),r.n(t)),s=r("gw9Z");const c={class:"preview-wrapper"},i={class:"operate-area"},u={style:{"margin-right":"10px"}},d={key:0},f=["placeholder"],p={key:1},h=["accept"];t={__name:"previewWrapper",props:{accept:String,placeholder:String,defaultSrc:String},setup(e){const t=e,{type:r,inputSrc:a,src:o,beforeUpload:b}=function(e){var t=(0,n.KR)("url"),r=(0,n.KR)(e);const l=(0,n.KR)(e);return e=(0,n.KR)([]),{type:t,inputSrc:r,src:l,fileList:e,beforeUpload:function(e){var t=new FileReader;return t.onload=e=>{e=e.target.result,l.value=e},t.readAsArrayBuffer(e.target.files[0]),!1}}}(t.defaultSrc);return(v,m)=>((0,l.uX)(),(0,l.CE)("div",c,[(0,l.Lk)("div",i,[(0,l.Lk)("div",u,["upload"===(0,n.R1)(r)?((0,l.uX)(),(0,l.CE)("button",{key:0,value:"url",onClick:m[0]||(m[0]=e=>r.value="url")},"远程文件地址")):(0,l.Q3)("",!0),"url"===(0,n.R1)(r)?((0,l.uX)(),(0,l.CE)("button",{key:1,value:"upload",onClick:m[1]||(m[1]=e=>r.value="upload")},"上传本地文件")):(0,l.Q3)("",!0)]),"url"===(0,n.R1)(r)?((0,l.uX)(),(0,l.CE)("div",d,[(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":m[2]||(m[2]=e=>(0,n.i9)(a)?a.value=e:null),placeholder:t.placeholder,style:{width:"600px","margin-left":"10px"}},null,8,f),[[s.Jo,(0,n.R1)(a)]]),(0,l.Lk)("button",{type:"primary",style:{"margin-left":"10px"},onClick:m[3]||(m[3]=e=>o.value=(0,n.R1)(a))}," 预览 ")])):(0,l.Q3)("",!0),"url"!==(0,n.R1)(r)?((0,l.uX)(),(0,l.CE)("div",p,[(0,l.Lk)("input",{accept:e.accept,type:"file",onChange:m[4]||(m[4]=(...e)=>(0,n.R1)(b)&&(0,n.R1)(b)(...e))},null,40,h)])):(0,l.Q3)("",!0)]),(0,l.RG)(v.$slots,"default",{src:(0,n.R1)(o)})]))}};var b=r("uaZu"),v=(0,b.A)(t,[["__scopeId","data-v-51c2a195"]]),m=(t={__name:"docxDemo",props:{baseUrl:String},setup(e){return(t,r)=>((0,l.uX)(),(0,l.Wv)(v,{accept:".docx",placeholder:"请输入docx文件地址","default-src":e.baseUrl+"demo-static/excel-preview-edit/mock-file/01test.docx"},{default:(0,l.k6)((e=>[(0,l.bF)((0,n.R1)(o()),{src:e.src,style:{flex:"1",height:"0"}},null,8,["src"])])),_:1},8,["default-src"]))}},t=(0,b.A)(t,[["__scopeId","data-v-65b0f684"]]),r("tpBA")),x=r.n(m),g=(m={__name:"excelDemo",props:{baseUrl:String},setup(e){return(t,r)=>((0,l.uX)(),(0,l.Wv)(v,{accept:".xlsx",placeholder:"请输入xlsx文件地址","default-src":e.baseUrl+"demo-static/excel-preview-edit/mock-file/01test.xlsx"},{default:(0,l.k6)((e=>[(0,l.bF)((0,n.R1)(x()),{src:e.src,style:{flex:"1",height:"0"}},null,8,["src"])])),_:1},8,["default-src"]))}},r("oUfE")),k=r.n(g),R=(g={__name:"pdfDemo",props:{baseUrl:String},setup(e){return(t,r)=>((0,l.uX)(),(0,l.Wv)(v,{accept:".pdf",placeholder:"请输入pdf文件地址","default-src":e.baseUrl+"demo-static/excel-preview-edit/mock-file/01test.pdf"},{default:(0,l.k6)((e=>[(0,l.bF)((0,n.R1)(k()),{src:e.src,style:{flex:"1",height:"0"}},null,8,["src"])])),_:1},8,["default-src"]))}},r("60oc"),{props:{tabsList:{type:Array,default:()=>[]},activeIndex:{type:Number,default:0}},setup(e,{slots:t}){const r=(0,n.Kh)([]),l=(0,n.KR)(e.activeIndex);return t.default().forEach(((e,t)=>{r.push({ifShow:l.value===t,ifRender:l.value===t,component:(0,n.IG)(e)})})),{currentIndex:l,slotList:r}},render(){return(0,l.bF)("div",{class:"flex flex-direction-column height100"},[(0,l.bF)("div",{class:"flex tabs"},[this.tabsList.map(((e,t)=>(0,l.bF)("div",{class:"cursor-pointer tabs-item",style:{borderRight:"1px solid #000",...0===t?{borderLeft:"1px solid #000"}:{},...this.currentIndex===t?{color:"green",fontWeight:"bolder"}:{}},onClick:()=>{this.slotList[t].ifRender=!0,this.currentIndex=t,this.slotList.forEach(((e,t)=>{e.ifShow=t===this.currentIndex}))},key:t},[e.title])))]),(0,l.bF)("div",{class:"overflow-auto flex-1"},[(0,l.bF)("div",null,[this.slotList.map((e=>{var t=e.component;return e.ifRender?(0,l.bF)(t,{style:e.ifShow?{}:{display:"none"}},null):null}))])])])}}),y=(R=(0,b.A)(R,[["__scopeId","data-v-4f6bc909"]]),r("HlMS")),U=(0,b.A)({components:{tabs:R,DocxDemo:t,ExcelDemo:m,PdfDemo:g},setup(){return{baseUrl:(0,y.ar)()}}},[["render",function(e,t,r,n,o,s){const c=(0,l.g2)("DocxDemo"),i=(0,l.g2)("ExcelDemo"),u=(0,l.g2)("PdfDemo");var d=(0,l.g2)("tabs");return(0,l.uX)(),(0,l.CE)("div",a,[(0,l.bF)(d,{tabsList:[{title:"预览docx"},{title:"预览excel"},{title:"预览pdf"}]},{default:(0,l.k6)((()=>[(0,l.bF)(c,{baseUrl:n.baseUrl},null,8,["baseUrl"]),(0,l.bF)(i,{baseUrl:n.baseUrl},null,8,["baseUrl"]),(0,l.bF)(u,{baseUrl:n.baseUrl},null,8,["baseUrl"])])),_:1})])}],["__scopeId","data-v-70a7857e"]])}}]);