## 关于301永久重定向

疫情耽搁，直接2个礼拜啥也没干



> 301转向(或叫[301重定向](https://baike.baidu.com/item/301重定向/1135400)，301跳转)是当用户或搜索引擎向[网站服务器](https://baike.baidu.com/item/网站服务器/8156379)发出浏览请求时，服务器返回的HTTP数据流中头信息(header)中的状态码的一种，表示本网页永久性转移到另一个地址。301重定向主要是将需要转移的网址重定向另一个新的网址上，并且是永久性转移。

页面永久性移走(301重定向)是一种非常重要的[自动转向技术](https://baike.baidu.com/item/自动转向技术)。在更换[域名](https://baike.baidu.com/item/域名)的时候起着不可替代的作用，他不仅可以实现网页的批量指定转跳，还可促进[搜索引擎优化](https://baike.baidu.com/item/搜索引擎优化)效果。不同于302，从搜索引擎优化角度出发，301重定向是网址重定向最为可行的一种办法。当网站的域名发生变更后，搜索引擎只对新网址进行索引，同时又会把旧地址下原有的外部链接如数转移到新地址下，从而不会让网站的[排名](https://baike.baidu.com/item/排名)因为网址变更而受到丝毫影响。当然各个搜索引擎对301的处理方式是不一样的。

| 状态码 | 状态短语           | 状态含义                                                     |
| :----- | :----------------- | :----------------------------------------------------------- |
| 300    | Multiple Choices   | 当请求的 URL 对应有多个资源时（如同一个 HTML 的不同语言的版本），返回这个代码时，可以返回一个可选列表，这样用户可以自行选择。通过 Location 头字段可以自定首选内容。 |
| 301    | Moved Permanetly   | 当前请求的资源已被移除时使用，响应的 Location 头字段会提供资源现在的 URL。直接使用 GET 方法发起新情求。 |
| 302    | Found              | 与 301 类似，但客户端只应该将 Location 返回的 URL 当做临时资源来使用，将来请求时，还是用老的 URL。直接使用 GET 方法发起新情求。 |
| 303    | See Other          | 用于在 PUT 或者 POST 请求之后进行重定向，这样在结果页就不会再次触发重定向了。 |
| 304    | Not Modified       | 资源未修改，表示本地缓存仍然可用。                           |
| 305    | Use Proxy          | 用来表示必须通过一个代理来访问资源，代理的位置有 Location 头字段给出 |
| 306    | Switch Proxy       | 在最新版的规范中，306 状态码已经不再被使用。最初是指“后续请求应使用指定的代理”。 |
| 307    | Temporary Redirect | 与 302 类似，但是使用原请求方法发起新情求。                  |
| 308    | Permanent Redirect | 与 301 类似，但是使用原请求方法发起新情求。                  |

301 和 308 都属于永久重定向。永久重定向意味着原始 URL 不再可用，替换成了一个新的内容。所以**搜索引擎、聚合内容阅读器以及其他爬虫识别这两个状态码时，会更新旧 URL 的资源**，这个就是永久重定向和临时重定向的区别。规范中，301 本来不允许改变请求方法，但是已有的浏览器厂商都使用了 GET 方法进行新的请求。所以创建了 308 用来处理需要使用非 GET 进行重定向的场景。

302/303/307 都属于临时重定向。有时，当原有资源因为一些不可预测的原因而临时无法访问时，可以通过临时重定向的方式将请求转移到另一个地方。搜索引擎和爬虫不应该记住这个临时的连接。此外，临时重定向还可以用来在创建、修改和删除时展示临时的进度页，通常使用 303。

特殊重定向类：300/304/305/306 可以归属到特殊重定向类。这里重点说一下 304，304 是 HTTP 缓存中的一个重要内容，表示资源未修改，相当于将资源重定向到本地缓存。

## **重定向的使用场景**

不同类别的重定向有不同的使用场景，大致可以分为以下几类：

- 网站别名，通常情况下，对于一个资源，我们只有一个 URL，但有些特殊情况下，资源会存在多个 URL，这个时候就需要用到重定向。

  提高网站的可达率：比如 `www.example.com` 和 `example.com`都可以访问到指定网站。

  迁移到新的站点：因为某些原因旧站点被废弃，但仍然希望之前已经存在的连接和收藏书签能够生效，这是可以使用重定向。

  强制跳转 HTTPS：当我们的网站支持 HTTPS 时，通常会强制使用 HTTPS，所以访问 HTTP 时需要做重定向跳转。

- **保证已有链接可用**：站点的维护是一个长时间的过程，有时，我们在进行重构时，会对一些链接或路由进行调整，这时候我们内部的 URL 可以修改，但是对于已在被外部引用了的链接却无法修改。为了保证这部分的链接可用，我们通常需要设置重定向。

- **对于危险操作进行重定向**：类似编辑删除等危险操作，为了避免用户刷新时重复触发危险操作，我们可以将其重定向到临时的进度展示页，比如使用 303。对于耗时较长的请求也可以这么处理。