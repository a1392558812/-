(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["UserManagement"],{"234b":function(e,t,r){"use strict";r.d(t,"f",(function(){return a})),r.d(t,"d",(function(){return i})),r.d(t,"c",(function(){return n})),r.d(t,"e",(function(){return s})),r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return l}));r("c975");var a=/^[A-Za-z]{1}[A-Za-z0-9_-]{3,15}$/,i=/(?=^.{6,16}$)(?=.*\d)(?=.*[A-Z])(?=.*[a-z])(?=.*[!@#$%^&*]).*$/,n=/^[a-z0-9]{1}[a-z0-9_-]{1,}@[a-z0-9]{1,}(\.[a-z]{2,})*\.[a-z]{2,}$/,s=/^1[345678]{1}\d{9}$/,o=function(e){return""===e?{valid:!1,message:"请输入名称"}:-1!==e.indexOf(" ")?{valid:!1,message:"名称不能包含空格"}:e.length<2||e.length>15?{valid:!1,message:"名称长度最小为2，最大为15"}:{valid:!0}},l=function(e){return e?-1!==e.indexOf(" ")?{valid:!1,message:"参数不能包含空格"}:e.length<4||e.length>20?{valid:!1,message:"参数长度最小为4，最大为20"}:{valid:!0}:{valid:!0,message:"请输入参数"}}},"2eee":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"roles"},[r("el-card",{staticClass:"roles-main"},[r("el-breadcrumb",{staticClass:"user-nav",attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),r("el-breadcrumb-item",[e._v("权限管理")]),r("el-breadcrumb-item",[e._v("角色列表")])],1),r("el-button",{staticStyle:{"margin-top":"20px"},attrs:{type:"primary"}},[e._v("添加角色")]),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.ifLoading,expression:"ifLoading"}],staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:e.roleList,border:"",stripe:"",height:"590px"},on:{"cell-dblclick":e.handleEditFun}},[r("el-table-column",{attrs:{type:"expand",width:"80px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-row",{staticClass:"role-grid"},[r("el-col",{staticClass:"el-col-span-3",attrs:{span:3}},[r("el-tag",{staticStyle:{"margin-top":"20px"}},[e._v(" "+e._s(t.row.role_name)+" ")]),r("i",{staticClass:"el-icon-caret-right"})],1),r("el-col",{attrs:{span:21}},e._l(t.row.children,(function(a,i){return a.children[0]?r("el-row",{key:a._id,staticClass:"role-grid-bottomBorder",class:0===i&&a.children[0]?"role-grid-topBorder":""},[r("el-col",{attrs:{span:8}},[a.children[0]?r("el-tag",{staticStyle:{"margin-top":"20px"},attrs:{closable:!0,"disable-transitions":!0,type:"success",hit:!0},on:{close:function(r){return e.fatherTagClose(t.$index,i)}}},[e._v(" "+e._s(a.authName)+" ")]):e._e(),a.children[0]?r("i",{staticClass:"el-icon-caret-right"}):e._e()],1),r("el-col",{attrs:{span:16}},e._l(a.children,(function(a,n){return r("el-tag",{key:a._id,staticStyle:{margin:"20px 20px 0 0"},attrs:{closable:!0,"disable-transitions":!0,type:"warning",hit:!0},on:{close:function(r){return e.childTagClose(t.$index,i,n)}}},[e._v(" "+e._s(a.authName)+" ")])})),1)],1):e._e()})),1)],1)]}}])}),r("el-table-column",{attrs:{label:"索引",type:"index"}}),r("el-table-column",{attrs:{label:"角色名称(双击修改)"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tag",{attrs:{type:"success",size:"medium"}},[e._v(" "+e._s(t.row.role_name)+" ")])]}}])}),r("el-table-column",{attrs:{label:"角色描述(双击修改)"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"info",size:"mini",plain:""}},[e._v(e._s(t.row.role_desc))])]}}])}),r("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{staticStyle:{"margin-left":"20px"},attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(r){return r.stopPropagation(),e.handleDelete(t.$index,t.row)}}},[e._v("删除")]),r("el-button",{staticStyle:{"margin-left":"20px"},attrs:{size:"mini",icon:"el-icon-setting",type:"warning"},on:{click:function(r){return e.handleEdit(t.$index,t.row)}}},[e._v("分配权限")])]}}])})],1)],1),r("DistributeDialog",{attrs:{getRequestRights:e.getRequestRights,roleList:e.roleList},on:{distributeDialogOpen:e.distributeDialogOpen}})],1)},i=[],n=(r("a434"),r("d3b7"),r("96cf"),r("1da1")),s=r("9aea"),o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-dialog",{attrs:{title:"收货地址","destroy-on-close":!0,visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t},close:e.dialogClose}},[r("el-tree",{ref:"tree",attrs:{data:e.allRoleList,"show-checkbox":"","default-expand-all":"","current-node-key":"defaultCheckedNodeKeys","default-checked-keys":e.defaultCheckedNodeKeys,"node-key":"id","highlight-current":"",props:e.defaultProps}}),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.dialogClickCancel}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.dialogClickAssign}},[e._v("确 定")])],1)],1)],1)},l=[],c={props:{getRequestRights:{type:Function},roleList:{type:Array}},data:function(){return{dialogVisible:!1,defaultCheckedNodeKeys:[],allRoleList:[],nowClick:{},role_root:{},defaultProps:{children:"children",label:"label"}}},created:function(){var e=this;this.getRequestAllRoleList(),this.$emit("distributeDialogOpen",(function(t,r){e.role_root=r.role_root;var a=[];for(var i in r.role_root)for(var n=0;n<r.role_root[i].length;n++)a.push(r.role_root[i][n]);e.defaultCheckedNodeKeys=a,e.nowClick.index=t,e.nowClick.value=r,e.dialogVisible=!e.dialogVisible}))},methods:{getRequestRoleUpdate:function(e){var t=e._id,r=e.role_root,a=e.role_name,i=e.role_desc;return new Promise(function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(n,o){var l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(s["u"])({_id:t,role_root:r,role_name:a,role_desc:i});case 2:l=e.sent,0===l.code?n():o();case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}())},getRequestAllRoleList:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r,a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(s["e"])();case 2:if(r=t.sent,0===r.code){for(a=0;a<r.data.length;a++)if(r.data[a].id=r.data[a].root_id,r.data[a].label=r.data[a].authName+"("+r.data[a].root_id+")",r.data[a].children[0])for(i=0;i<r.data[a].children.length;i++)r.data[a].children[i].id=r.data[a].children[i].root_id,r.data[a].children[i].label=r.data[a].children[i].authName;e.allRoleList=r.data}else e.$message.error("权限获取失败了");case 4:case"end":return t.stop()}}),t)})))()},dialogClose:function(){this.defaultCheckedNodeKeys=[]},dialogClickAssign:function(){var e=this,t=this.$refs.tree.getCheckedNodes(!0,!0),r={};for(var a in this.nowClick.value.role_root){r[a]=[];for(var i=0;i<t.length;i++)t[i].parentId===a&&r[a].push(t[i].root_id)}var n=this.nowClick.value._id;this.getRequestRoleUpdate({_id:n,role_root:r}).then((function(){e.$message.success("权限修改成功"),e.getRequestRights(),e.dialogVisible=!1}),(function(){e.$message.success("权限修改失败")}))},dialogClickCancel:function(){this.dialogVisible=!1}},components:{}},u=c,d=r("2877"),p=Object(d["a"])(u,o,l,!1,null,"f7989fcc",null),m=p.exports,f={data:function(){return{ifLoading:!1,roleList:[]}},created:function(){this.getRequestRights()},methods:{distributeDialogOpen:function(e){this.fun=e},getRequestRoleUpdate:function(e){var t=this,r=e._id,a=e.role_root,i=e.role_name,o=e.role_desc;return new Promise(function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(n,l){var c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.ifLoading=!0,e.next=3,Object(s["u"])({_id:r,role_root:a,role_name:i,role_desc:o});case 3:c=e.sent,t.ifLoading=!1,0===c.code?n():l();case 6:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}())},fatherTagClose:function(e,t){var r=this,a=this.roleList[e]._id,i=this.roleList[e].children[t].root_id;this.$confirm('此操作将永久删除"'.concat(this.roleList[e].children[t].authName,'", 是否继续?'),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){r.roleList[e].role_root[i]=[];var n=r.roleList[e].role_root;r.roleList[e].children[t].children=[],r.getRequestRoleUpdate({_id:a,role_root:n}).then((function(){r.$message({type:"success",message:"删除成功!"})}))})).catch((function(){r.$message({type:"info",message:"已取消删除"})}))},childTagClose:function(e,t,r){var a=this,i=this.roleList[e]._id,n=this.roleList[e].children[t].root_id;this.$confirm('此操作将永久删除"'.concat(this.roleList[e].children[t].children[r].authName,'", 是否继续?'),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var s=a.roleList[e].role_root;s[n].splice(r,1),a.roleList[e].children[t].children.splice(r,1),a.getRequestRoleUpdate({_id:i,role_root:s}).then((function(){a.$message({type:"success",message:"删除成功!"})}))})).catch((function(){a.$message({type:"info",message:"已取消删除"})}))},handleDelete:function(e,t){var r=this;this.$confirm('此操作将永久删除"'.concat(t.role_name,'", 是否继续?'),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){r.$message({type:"success",message:"假装删除成功!"})})).catch((function(){r.$message({type:"info",message:"已取消删除"})}))},handleEditFun:function(e,t,r,a){var i=this,n=t.label;if("角色名称(双击修改)"===n)n="名称";else{if("角色描述(双击修改)"!==n)return;n="描述"}this.$prompt("请输入新角色".concat(n),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^[^\s]*$/,inputErrorMessage:"".concat(n,"格式不正确")}).then((function(t){var r=t.value,a=e._id;"描述"===n?i.getRequestRoleUpdate({_id:a,role_desc:r}).then((function(){i.getRequestRights()})):i.getRequestRoleUpdate({_id:a,role_name:r}).then((function(){i.getRequestRights()})),i.$message({type:"success",message:"更新角色".concat(n,"成功")})})).catch((function(){i.$message({type:"info",message:"取消输入"})}))},handleEdit:function(e,t){this.fun(e,t)},getRequestRights:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(s["s"])();case 2:r=t.sent,0===r.code&&(e.roleList=r.data);case 4:case"end":return t.stop()}}),t)})))()}},components:{DistributeDialog:m}},g=f,h=(r("528b"),Object(d["a"])(g,a,i,!1,null,"cd937484",null));t["default"]=h.exports},"3d4e":function(e,t,r){"use strict";var a=r("7bf8"),i=r.n(a);i.a},"43a6":function(e,t,r){},"498a":function(e,t,r){"use strict";var a=r("23e7"),i=r("58a8").trim,n=r("c8d2");a({target:"String",proto:!0,forced:n("trim")},{trim:function(){return i(this)}})},"528b":function(e,t,r){"use strict";var a=r("ce2b"),i=r.n(a);i.a},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,r){var a=r("1d80"),i=r("5899"),n="["+i+"]",s=RegExp("^"+n+n+"*"),o=RegExp(n+n+"*$"),l=function(e){return function(t){var r=String(a(t));return 1&e&&(r=r.replace(s,"")),2&e&&(r=r.replace(o,"")),r}};e.exports={start:l(1),end:l(2),trim:l(3)}},7156:function(e,t,r){var a=r("861d"),i=r("d2bb");e.exports=function(e,t,r){var n,s;return i&&"function"==typeof(n=t.constructor)&&n!==r&&a(s=n.prototype)&&s!==r.prototype&&i(e,s),e}},"736f":function(e,t,r){},"7bf8":function(e,t,r){},"7d43":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"user"},[r("el-card",{staticClass:"box-card user-box-card"},[r("el-breadcrumb",{staticClass:"user-nav",attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),r("el-breadcrumb-item",[e._v("用户管理")]),r("el-breadcrumb-item",[e._v("用户列表")])],1),r("el-card",{staticClass:"user-main"},[r("div",{staticClass:"user-main-search-add"},[r("el-input",{staticClass:"input-with-select",staticStyle:{width:"250px"},attrs:{placeholder:"请输入内容"},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}}),r("el-button",{staticStyle:{"margin-right":"15px"},attrs:{slot:"suffix",type:"primary",icon:"el-icon-search"},on:{click:e.searchUser},slot:"suffix"}),r("el-button",{staticStyle:{"margin-right":"15px"},attrs:{type:"primary"},on:{click:e.searchAllUser}},[e._v("查询所有admin")]),r("el-button",{attrs:{type:"primary"},on:{click:e.addUser}},[e._v("添加用户")])],1),r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.userList,border:"",stripe:""}},[r("el-table-column",{attrs:{label:"#",type:"index"}}),r("el-table-column",{attrs:{label:"姓名"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-popover",{attrs:{trigger:"hover",placement:"top"}},[r("p",[e._v("姓名: "+e._s(t.row.username))]),r("p",[e._v("创建日期: "+e._s(t.row.create_time))]),r("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[r("el-tag",{attrs:{size:"medium"}},[r("i",{staticClass:"el-icon-user-solid"}),e._v(" "+e._s(t.row.username)+" ")])],1)])]}}])}),r("el-table-column",{attrs:{label:"📪邮箱"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("i",{staticClass:"el-icon-message"}),r("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.email))])]}}])}),r("el-table-column",{attrs:{label:"电话☎"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("i",{staticClass:"el-icon-phone-outline"}),r("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.mobile))])]}}])}),r("el-table-column",{attrs:{label:"角色"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("i",{staticClass:"el-icon-user"}),r("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.role_name))])]}}])}),r("el-table-column",{attrs:{label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-switch",{attrs:{"active-color":"#409EFF","inactive-color":"#eee"},on:{change:function(r){return e.changeUserState(t.row)}},model:{value:t.row.mg_state,callback:function(r){e.$set(t.row,"mg_state",r)},expression:"scope.row.mg_state"}})]}}])}),r("el-table-column",{staticClass:"actionBtn",attrs:{label:"操作",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tooltip",{attrs:{content:"修改按钮",placement:"top",enterable:!1}},[r("el-button",{staticStyle:{"margin-left":"15px"},attrs:{type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(r){return e.handleUpdate(t.$index,t.row)}}})],1),r("el-tooltip",{attrs:{content:"删除按钮",placement:"top",enterable:!1}},[r("el-button",{staticStyle:{"margin-left":"15px"},attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(r){return e.handleDelete(t.$index,t.row)}}})],1),r("el-tooltip",{attrs:{content:"分配角色按钮",placement:"top",enterable:!1}},[r("el-button",{staticStyle:{"margin-left":"15px"},attrs:{type:"warning",icon:"el-icon-setting",circle:""},on:{click:function(r){return e.handleRole(t.$index,t.row)}}})],1)]}}])})],1),r("div",{staticClass:"block"},[r("el-pagination",{attrs:{"current-page":e.pagenum,"page-size":7,layout:"total, prev, pager, next, jumper",total:e.total},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.pagenum=t},"update:current-page":function(t){e.pagenum=t}}})],1)],1)],1),r("DialogAdd",{attrs:{callbackList:e.callbackList},on:{handelDialogAdd:e.handelDialogAdd}}),r("DialogUpdate",{attrs:{pagenum:e.pagenum,callbackUpdate:e.callbackUpdate,nowClick:e.nowClick,callbackList:e.callbackList},on:{handelDialogUpdate:e.handelDialogUpdate}}),r("DialogDistribute",{attrs:{selectOptions:e.selectOptions,pagenum:e.pagenum,getRequestUserList:e.getRequestUserList,getRequestUpdateUser:e.getRequestUpdateUser,nowClick:e.nowClick},on:{distributeDialog:e.distributeDialog}})],1)},i=[],n=(r("d3b7"),r("498a"),r("96cf"),r("1da1")),s=r("9aea"),o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-dialog",{attrs:{title:"添加用户",width:"750px",visible:e.ifOpen},on:{"update:visible":function(t){e.ifOpen=t},close:e.dialogIsClosed}},[r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"70px"}},[r("el-form-item",{attrs:{label:"用户名",prop:"username"}},[r("el-input",{staticStyle:{width:"600px"},attrs:{autocomplete:"off"},model:{value:e.ruleForm.username,callback:function(t){e.$set(e.ruleForm,"username",t)},expression:"ruleForm.username"}})],1),r("el-form-item",{attrs:{label:"用户密码",prop:"password"}},[r("el-input",{staticStyle:{width:"600px"},attrs:{type:"password",autocomplete:"off"},model:{value:e.ruleForm.password,callback:function(t){e.$set(e.ruleForm,"password",t)},expression:"ruleForm.password"}})],1),r("el-form-item",{attrs:{label:"确认密码",prop:"password2"}},[r("el-input",{staticStyle:{width:"600px"},attrs:{type:"password",autocomplete:"off"},model:{value:e.ruleForm.password2,callback:function(t){e.$set(e.ruleForm,"password2",t)},expression:"ruleForm.password2"}})],1),r("el-form-item",{attrs:{label:"📪邮箱",prop:"email"}},[r("el-input",{staticStyle:{width:"600px"},attrs:{autocomplete:"off"},model:{value:e.ruleForm.email,callback:function(t){e.$set(e.ruleForm,"email",t)},expression:"ruleForm.email"}})],1),r("el-form-item",{attrs:{label:"📱手机号",prop:"mobile"}},[r("el-input",{staticStyle:{width:"600px"},attrs:{type:"number",autocomplete:"off"},model:{value:e.ruleForm.mobile,callback:function(t){e.$set(e.ruleForm,"mobile",t)},expression:"ruleForm.mobile"}})],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.closeDialog}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.submitAddUser}},[e._v("确 定")])],1)],1)],1)},l=[],c=r("234b"),u={props:{callbackList:{type:Function}},data:function(){return{ifOpen:!1,ruleForm:{username:"",password2:"",password:"",email:"",mobile:""},rules:{username:[{validator:this.checkUsername,trigger:"blur"}],password:[{validator:this.checkPassword,trigger:"blur"}],password2:[{validator:this.checkPassword2,trigger:"blur"}],email:[{validator:this.checkEmail,trigger:"blur"}],mobile:[{validator:this.checkMobile,trigger:"blur"}]},formLabelWidth:"120px"}},created:function(){var e=this;this.$emit("handelDialogAdd",(function(){e.ifOpen=!e.ifOpen}))},methods:{getRequestAddUser:function(e){var t=this,r=e.username,a=e.password,i=e.email,o=e.mobile;return new Promise(function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(n,l){var c,u,d;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(s["d"])({username:r,password:a,email:i,mobile:o});case 2:c=e.sent,0===c.code?(t.$message.success("添加用户成功"),u=1,d=7,t.callbackList({pagenum:u,pagesize:d}),n(c)):2===c.code?(t.$message.error("该账号已被使用了"),l()):(t.$message.error("添加用户失败"),l());case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}())},dialogIsClosed:function(){this.$refs.ruleForm.resetFields()},closeDialog:function(){this.ifOpen=!1},submitAddUser:function(){var e=this;this.$refs.ruleForm.validate((function(t){if(t){var r=e.ruleForm,a=r.username,i=r.password,n=r.email,s=r.mobile;e.getRequestAddUser({username:a,password:i,email:n,mobile:s}).then((function(t){e.ifOpen=!1}),(function(e){}))}else e.$message.warning("还有字段未通过验证，请仔细检查")}))},checkUsername:function(e,t,r){t?c["f"].test(t)?r():r(new Error("必须是以字母开头，只能包含字母数字下划线和减号，4到16位")):r(new Error("账号不能为空"))},checkPassword:function(e,t,r){""===t?r(new Error("请输入密码")):c["d"].test(t)?r():r(new Error("6-16位，至少有一个数字一个大写字母一个小写字母和一个特殊字符"))},checkPassword2:function(e,t,r){""===t?r(new Error("请再次输入密码")):t!==this.ruleForm.password?r(new Error("两次输入密码不一致!")):r()},checkEmail:function(e,t,r){""===t?r(new Error("请输入邮箱📪")):c["c"].test(t)?r():r(new Error("邮箱格式不正确"))},checkMobile:function(e,t,r){""===t?r(new Error("请输入📱手机号")):c["e"].test(t)?r():r(new Error("手机号格式不正确"))}},components:{}},d=u,p=r("2877"),m=Object(p["a"])(d,o,l,!1,null,null,null),f=m.exports,g=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-dialog",{attrs:{title:"跟新用户信息",width:"750px",visible:e.ifOpen},on:{"update:visible":function(t){e.ifOpen=t},open:e.dialogUpdateOpenFun,close:e.dialogUpdateCloseFun}},[r("el-form",{ref:"updateForm",attrs:{model:e.updateForm,"status-icon":"",rules:e.rules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"用户名"}},[r("el-input",{staticStyle:{width:"600px"},attrs:{disabled:!0},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}})],1),r("el-form-item",{attrs:{label:"📪邮箱号",prop:"email"}},[r("el-input",{staticStyle:{width:"600px"},attrs:{autocomplete:"off"},model:{value:e.updateForm.email,callback:function(t){e.$set(e.updateForm,"email",t)},expression:"updateForm.email"}})],1),r("el-form-item",{attrs:{label:"手机号",prop:"mobile"}},[r("el-input",{staticStyle:{width:"600px"},attrs:{type:"number",autocomplete:"off"},model:{value:e.updateForm.mobile,callback:function(t){e.$set(e.updateForm,"mobile",t)},expression:"updateForm.mobile"}})],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.submitCancel}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.submitUpdate}},[e._v("确 定")])],1)],1)],1)},h=[],b=(r("a9e3"),{props:{pagenum:{type:Number},nowClick:{type:Object},callbackUpdate:{type:Function},callbackList:{type:Function}},data:function(){return{username:"",ifOpen:!1,updateForm:{email:"",mobile:null},rules:{email:[{validator:this.checkEmail,trigger:"blur"}],mobile:[{validator:this.checkMobile,trigger:"blur"}]}}},created:function(){var e=this;this.$emit("handelDialogUpdate",(function(){e.ifOpen=!e.ifOpen}))},methods:{dialogUpdateOpenFun:function(){this.username=this.nowClick.username,this.updateForm.email=this.nowClick.email,this.updateForm.mobile=this.nowClick.mobile},dialogUpdateCloseFun:function(){this.$refs.updateForm.resetFields()},submitUpdate:function(){var e=this;this.$refs.updateForm.validate((function(t){if(t){var r=e.updateForm,a=r.email,i=r.mobile,n=e.nowClick._id;e.callbackUpdate({_id:n,email:a,mobile:i}).then((function(t){var r=e.pagenum,a=7;e.callbackList({pagenum:r,pagesize:a})}),(function(e){}))}else e.$message.warning("还有字段未通过验证，请仔细检查")})),this.ifOpen=!1},submitCancel:function(){this.ifOpen=!1},checkEmail:function(e,t,r){""===t?r(new Error("请输入邮箱📪")):c["c"].test(t)?r():r(new Error("邮箱格式不正确"))},checkMobile:function(e,t,r){""===t?r(new Error("请输入📱手机号")):c["e"].test(t)?r():r(new Error("手机号格式不正确"))}},components:{}}),v=b,_=Object(p["a"])(v,g,h,!1,null,null,null),w=_.exports,y=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-dialog",{attrs:{title:"提示",visible:e.dialogVisible,"destroy-on-close":!0,width:"30%"},on:{open:e.dialogIsOpen,closed:e.dialogIsClose,"update:visible":function(t){e.dialogVisible=t}}},[r("div",{staticClass:"select-main"},[r("p",{staticStyle:{"margin-bottom":"20px"}},[r("el-tag",{staticStyle:{"margin-right":"10px"}},[e._v("当前用户:")]),e._v(e._s(this.nowClick.username)+" ")],1),r("p",{staticStyle:{"margin-bottom":"20px"}},[r("el-tag",{staticStyle:{"margin-right":"10px"}},[e._v("当前用户角色:")]),e._v(e._s(this.nowClick.role_name)+" ")],1),r("p",[r("span",[r("el-tag",{staticStyle:{"margin-right":"10px"}},[e._v("分配新角色:")])],1),r("el-select",{ref:"selectRef",staticStyle:{width:"200px"},attrs:{placeholder:"请选择"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(this.selectOptions,(function(e){return r("el-option",{key:e._id,attrs:{label:e.role_name,value:e._id}})})),1)],1)]),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.dialogVisibleCancel}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.distributeDialogOk}},[e._v("确 定")])],1)])],1)},x=[],k={props:{pagenum:{type:Number},getRequestUpdateUser:{type:Function},getRequestUserList:{type:Function},selectOptions:{type:Array},nowClick:{type:Object}},data:function(){return{value:"",dialogVisible:!1}},created:function(){var e=this;this.$emit("distributeDialog",(function(){e.dialogVisible=!0}))},methods:{dialogIsOpen:function(){this.value=this.nowClick.role_id},dialogIsClose:function(){this.value=""},distributeDialogOk:function(){var e=this,t=this.$refs.selectRef.value,r=this.nowClick.role_id;if(r!==t){var a=this.nowClick._id;this.getRequestUpdateUser({_id:a,role_id:t}).then((function(){e.getRequestUserList({query:"",pagenum:e.pagenum,pagesize:7}),e.dialogVisible=!1}),(function(){}))}else this.$message.error("您未做出修改，请点击取消关闭")},dialogVisibleCancel:function(){this.dialogVisible=!1}},components:{}},R=k,C=(r("d48f"),Object(p["a"])(R,y,x,!1,null,"ef03e854",null)),U=C.exports,O={data:function(){var e=this;return{selectOptions:[],nowClick:{},input:"",pagenum:1,queryInfo:{query:"",pagenum:1,pagesize:7},userList:[],total:0,callbackList:function(t){var r=t.query,a=t.pagenum,i=t.pagesize;e.getRequestUserList({query:r,pagenum:a,pagesize:i})},callbackUpdate:function(t){var r=t._id,a=t.mg_state,i=t.email,n=t.mobile,s=t.role_id;return e.getRequestUpdateUser({_id:r,mg_state:a,email:i,mobile:n,role_id:s})}}},created:function(){var e=this.queryInfo,t=e.pagenum,r=e.pagesize;this.getRequestUserList({pagenum:t,pagesize:r}),this.getRequestAllRootList()},methods:{getRequestAllRootList:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(s["f"])();case 2:r=t.sent,0===r.code?e.selectOptions=r.data:e.$message.error("网络出错了，请刷新");case 4:case"end":return t.stop()}}),t)})))()},distributeDialog:function(e){this.openDistribute=e},getRequestDeleteUser:function(e){var t=e._id;return new Promise(function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(r,a){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(s["j"])({_id:t});case 2:i=e.sent,0===i.code?r():a();case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}())},handelDialogAdd:function(e){this.ChildDialogAdd=e},handelDialogUpdate:function(e){this.ChildDialogUpdate=e},addUser:function(){this.ChildDialogAdd()},searchAllUser:function(){var e=1,t="",r=7;this.input="",this.queryInfo.pagenum=e,this.queryInfo.query=t,this.queryInfo.pagesize=r,this.getRequestUserList({query:t,pagenum:e,pagesize:r})},searchUser:function(){var e=this.input;if(e){e=e.trim(),this.queryInfo.query=e;var t=this.queryInfo,r=t.pagenum,a=t.pagesize;this.getRequestUserList({query:e,pagenum:r,pagesize:a})}},getRequestUpdateUser:function(e){var t=this,r=e._id,a=e.mg_state,i=e.email,o=e.mobile,l=e.role_id;return new Promise(function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(n,c){var u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(s["z"])({_id:r,mg_state:a,email:i,mobile:o,role_id:l});case 2:u=e.sent,0===u.code?(t.$message.success("修改成功"),n(u.data)):(t.$message.error("修改失败"),c(u));case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}())},changeUserState:function(e){var t=e._id,r=e.mg_state;this.getRequestUpdateUser({_id:t,mg_state:r}).then((function(e){}),(function(t){e.mg_state=!r}))},handleRole:function(e,t){this.nowClick=t,this.openDistribute()},handleCurrentChange:function(e){this.pagenum=e;var t=e,r=this.queryInfo,a=r.query,i=r.pagesize;this.getRequestUserList({query:a,pagenum:t,pagesize:i})},handleDelete:function(e,t){var r=this;this.$confirm("此操作将永久删除该用户, 是否继续?","提示：正在删除".concat(t.username),{type:"warning",roundButton:!0,confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(){var e=t._id;r.getRequestDeleteUser({_id:e}).then((function(){r.$message({type:"success",message:"删除成功!"});var e=r.pagenum,t=7;r.getRequestUserList({pagenum:e,pagesize:t})}),(function(){r.$message({type:"info",message:"删除失败了emmmm"})}))})).catch((function(){r.$message({type:"info",message:"已取消删除"})}))},handleUpdate:function(e,t){this.nowClick=t,this.ChildDialogUpdate()},getRequestUserList:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var a,i,n,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=e.query,i=e.pagenum,n=e.pagesize,r.next=3,Object(s["A"])({query:a,pagenum:i,pagesize:n});case 3:o=r.sent,0===o.code?(t.userList=o.data.users,t.total=o.data.total,t.pagenum=1*o.data.pagenum):t.$message.error("数据获取失败了");case 5:case"end":return r.stop()}}),r)})))()}},components:{DialogAdd:f,DialogUpdate:w,DialogDistribute:U}},$=O,q=(r("3d4e"),Object(p["a"])($,a,i,!1,null,"2917d1d7",null));t["default"]=q.exports},"9e4e":function(e,t,r){"use strict";var a=r("736f"),i=r.n(a);i.a},a9e3:function(e,t,r){"use strict";var a=r("83ab"),i=r("da84"),n=r("94ca"),s=r("6eeb"),o=r("5135"),l=r("c6b6"),c=r("7156"),u=r("c04e"),d=r("d039"),p=r("7c73"),m=r("241c").f,f=r("06cf").f,g=r("9bf2").f,h=r("58a8").trim,b="Number",v=i[b],_=v.prototype,w=l(p(_))==b,y=function(e){var t,r,a,i,n,s,o,l,c=u(e,!1);if("string"==typeof c&&c.length>2)if(c=h(c),t=c.charCodeAt(0),43===t||45===t){if(r=c.charCodeAt(2),88===r||120===r)return NaN}else if(48===t){switch(c.charCodeAt(1)){case 66:case 98:a=2,i=49;break;case 79:case 111:a=8,i=55;break;default:return+c}for(n=c.slice(2),s=n.length,o=0;o<s;o++)if(l=n.charCodeAt(o),l<48||l>i)return NaN;return parseInt(n,a)}return+c};if(n(b,!v(" 0o1")||!v("0b1")||v("+0x1"))){for(var x,k=function(e){var t=arguments.length<1?0:e,r=this;return r instanceof k&&(w?d((function(){_.valueOf.call(r)})):l(r)!=b)?c(new v(y(t)),r,k):y(t)},R=a?m(v):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),C=0;R.length>C;C++)o(v,x=R[C])&&!o(k,x)&&g(k,x,f(v,x));k.prototype=_,_.constructor=k,s(i,b,k)}},b913:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"rights"},[r("el-card",{staticClass:"box-card rights-box-card"},[r("el-breadcrumb",{staticClass:"user-nav",attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),r("el-breadcrumb-item",[e._v("权限管理")]),r("el-breadcrumb-item",[e._v("权限列表")])],1),r("el-card",{staticStyle:{"margin-top":"20px"}},[r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.rightList,border:"",height:"600",stripe:""}},[r("el-table-column",{attrs:{label:"#",type:"index"}}),r("el-table-column",{attrs:{label:"权限名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.authName))])]}}])}),r("el-table-column",{attrs:{label:"路径"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.path?t.row.path:"父级路径"))])]}}])}),r("el-table-column",{attrs:{label:"权限等级"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",{staticStyle:{"margin-left":"10px"}},["0"===t.row.level?r("el-tag",{attrs:{type:"success"}},[e._v("一级")]):e._e(),"0"!==t.row.level?r("el-tag",{attrs:{type:"warning"}},[e._v("二级")]):e._e()],1)]}}])})],1)],1)],1)],1)},i=[],n=(r("96cf"),r("1da1")),s=r("9aea"),o={data:function(){return{rightList:[]}},created:function(){this.getRequestRightsList()},methods:{getRequestRightsList:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(s["t"])();case 2:r=t.sent,0===r.code?e.rightList=r.data:e.$message.error("权限获取失败了");case 4:case"end":return t.stop()}}),t)})))()}},components:{}},l=o,c=(r("9e4e"),r("2877")),u=Object(c["a"])(l,a,i,!1,null,"489d76e6",null);t["default"]=u.exports},c8d2:function(e,t,r){var a=r("d039"),i=r("5899"),n="​᠎";e.exports=function(e){return a((function(){return!!i[e]()||n[e]()!=n||i[e].name!==e}))}},c975:function(e,t,r){"use strict";var a=r("23e7"),i=r("4d64").indexOf,n=r("a640"),s=r("ae40"),o=[].indexOf,l=!!o&&1/[1].indexOf(1,-0)<0,c=n("indexOf"),u=s("indexOf",{ACCESSORS:!0,1:0});a({target:"Array",proto:!0,forced:l||!c||!u},{indexOf:function(e){return l?o.apply(this,arguments)||0:i(this,e,arguments.length>1?arguments[1]:void 0)}})},ce2b:function(e,t,r){},d48f:function(e,t,r){"use strict";var a=r("43a6"),i=r.n(a);i.a}}]);
//# sourceMappingURL=UserManagement.21f2f856.js.map