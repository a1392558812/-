## 如何修改第三方库node_modules源码

### 方法一

直接copy依赖包的源码，本地引用，不再通过npm包方式引用

```js
resolve: {  
    alias: {  
        'jquery': path.resolve(__dirname, './custom-modules/jquery/*'), 
    }
}
```

### 方法二

根据当前需要修改的库发布私有库，npm install时从私有库中下载自己修改了的库


### 方法三

> ！！！patch是锁定版本号的，如果升级了版本，patch内容将会失效。可以在package.json锁定版本号。

1. 安装插件(建议使用npm或者yarn安装)
    ```
        npm i patch-package --save-dev
    ```
2. 更改node_modules 文件夹中要修改依赖包的文件,比如我们修改了包`xxxxxx`的源码
3. 执行脚本打补丁（会在文件目录中生成一个patches文件夹） `npx patch-package xxxxxx`
4. 在`package.json`的`scripts`中加入`“postinstall”: “patch-package”`
    ```json
        "scripts": {
            "postinstall": "patch-package"
        }
    ```
5. 删除`node_modules`后重新安装依赖
6. 注意对于依赖包的修改地方，我们最好进行显著标识（比我我们修改了什么地方，修改新增了什么功能注释写明确）。因为对于复杂的修改，补丁文件可能变得难以管理。大型补丁或多次修改可能会导致补丁文件过于庞大

### 杂项

#### 是什么

patch-package是一个npm包，它可以让我们对node_modules中的任何包进行修改，并且将这些修改保存在一个patch文件中。这样，我们就可以在项目中使用这个patch文件来覆盖原始的包，从而实现对依赖包的定制化。

#### 原理

patch文件是一些git diff记录描述。patch-package会将当前 node_modules下的源码与原始源码进行 git diff，并在项目根目录下生成一个patch补丁文件。