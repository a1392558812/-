## uniapp的一些我自己容易忽略的点

> 说一些我自己容易忽略的点

* ### 全局赋值设备信息
  
  * 可以通过`uni.getSystemInfoSync()`获取设备信息，注意在封装时
  
  	```js
  	Vue.prototype.system = uni.getSystemInfoSync
  	// 不要写为 Vue.prototype.system = uni.getSystemInfoSync
  	// 写在main.js，意味着赋值代码只会被执行一次，且是APP启动的时候， 但是uni-app中，设备信息的windowHeight属性是不含APP的导航栏和tabbar高度在内的，当我们进入首页时，windowHeight不含tabbar高度在内，高度可能为 '700px'，但是进入内页后，没有tabbar，这时的windowHeight高度依然为700px(少掉了tabbar的50px高度)，显然是不正确的。
  	```
  
* ### 如何导出公共css变量 `:export`

  * ```scss
    $red: red;
    $orange: orange;
    $green: green;
    :export {
      colorRed: $red;
      colorOrange: $orange;
    }
    ```

    >  不仅可以在scss中使用这些变量，也可以在js中使用

  * ```vue
    <template>
      <view> 山东菏泽曹县！🐮🍺，666，我滴宝贝！！！！！ </view>
    </template>
    <script>
        import style from 'indec.scss'
        export default {
            created () {
                console.log('style', style)
            }
        }
    </script>
    ```

* ### 编译

  * 编译到任意平台时，`static` 目录下的文件均会被完整打包进去，即`static` 目录下的 `js` 文件不会被编译，如果里面有 `es6` 的代码，不经过转换直接运行，在手机设备上会报错，`css`、`less/scss` 等资源不要放在 `static` 目录下，建议这些公用的资源放在自建的 `common` 目录下

* ### 尺寸单位相关
  
  * 若设计稿宽度为 750px，元素 A 在设计稿上的宽度为 100px，那么元素 A 在 `uni-app` 里面的宽度应该设为：`750 * 100 / 750`，结果为：100rpx。
  * 若设计稿宽度为 640px，元素 A 在设计稿上的宽度为 100px，那么元素 A 在 `uni-app` 里面的宽度应该设为：`750 * 100 / 640`，结果为：117rpx。
  * 若设计稿宽度为 375px，元素 B 在设计稿上的宽度为 200px，那么元素 B 在 `uni-app` 里面的宽度应该设为：`750 * 200 / 375`，结果为：400rpx。
  
* ### uni-app 提供内置 CSS 变量，

  CSS 內使用 vh 单位的时候注意 100vh 包含导航栏，使用时需要减去导航栏和 tabBar 高度，部分浏览器还包含浏览器操作栏高度，使用时请注意。

    *    | CSS变量             | 描述                   | App                                                          | 小程序 | H5                   |
        | :------------------ | :--------------------- | :----------------------------------------------------------- | :----- | :------------------- |
        | --status-bar-height | 系统状态栏高度         | [系统状态栏高度](http://www.html5plus.org/doc/zh_cn/navigator.html#plus.navigator.getStatusbarHeight)、nvue注意见下 | 25px   | 0                    |
        | --window-top        | 内容区域距离顶部的距离 | 0                                                            | 0      | NavigationBar 的高度 |
        | --window-bottom     | 内容区域距离底部的距离 | 0                                                            | 0      | TabBar 的高度        |

    - `var(--status-bar-height)` 此变量在微信小程序环境为固定 `25px`，在 App 里为手机实际状态栏高度。
    - 当设置 `"navigationStyle":"custom"` 取消原生导航栏后，由于窗体为沉浸式，占据了状态栏位置。此时可以使用一个高度为 `var(--status-bar-height)` 的 view 放在页面顶部，避免页面内容出现在状态栏。
    - 由于在H5端，不存在原生导航栏和tabbar，也是前端div模拟。如果设置了一个固定位置的居底view，在小程序和App端是在tabbar上方，但在H5端会与tabbar重叠。此时可使用`--window-bottom`，不管在哪个端，都是固定在tabbar上方。
    - 目前 nvue 在App端，还不支持 `--status-bar-height`变量，替代方案是在页面onLoad时通过uni.getSystemInfoSync().statusBarHeight获取状态栏高度，然后通过style绑定方式给占位view设定高度。

* ### $getAppWebview()

  * `uni-app` 在 `getCurrentPages()`获得的页面里内置了一个方法 `$getAppWebview()` 可以得到当前webview的对象实例，从而实现对 webview 更强大的控制。

* ### 页面通信

  * ### [uni.$emit(eventName,OBJECT)](https://uniapp.dcloud.net.cn/api/window/communication?id=emit)

    触发全局的自定义事件，附加参数都会传给监听器回调函数。

  * ### [uni.$on(eventName,callback)](https://uniapp.dcloud.net.cn/api/window/communication?id=on)

    监听全局的自定义事件，事件由 `uni.$emit` 触发，回调函数会接收事件触发函数的传入参数。

  * ### [uni.$once(eventName,callback)](https://uniapp.dcloud.net.cn/api/window/communication?id=once)

    监听全局的自定义事件，事件由 `uni.$emit` 触发，但仅触发一次，在第一次触发之后移除该监听器。

  * ### [uni.$off([eventName, callback])](https://uniapp.dcloud.net.cn/api/window/communication?id=off)

    移除全局自定义事件监听器。

